#!@AWK@ -f

# LMDBG helper script
#
# Input:
#   malloc/realloc/free ...<SPACE>address1<SUBSEP>address2
# Output:
#   malloc/realloc/free ...
#    address1
#    address2

{
    num = 0

	if ($1 == "malloc")
		num = 7
	else if ($1 == "calloc" || $1 == "realloc")
		num = 9
	else if ($1 == "memalign" || $1 == "posix_memalign")
		num = 9
	else if ($1 == "free")
		num = 5
}

num > 0 {
	cnt = split($NF, arr, SUBSEP)

	$NF = ""
	print $0

	for (i=1; i <= cnt; ++i){
		gsub(/\033/, "\t", arr [i])
		print " " arr [i]
	}
	next
}

{
	print
}
