.\" Copyright (c) 2008-2011 by Aleksey Cheusov (vle@gmx.net)
.\" Absolutely no warranty.
.\"
.\" ------------------------------------------------------------------
.de VB \" Verbatim Begin
.ft CW
.nf
.ne \\$1
..
.de VE \" Verbatim End
.ft R
.fi
..
.\" ------------------------------------------------------------------
.TH LMDBG 1 "Nov 26, 2011" "" ""
.SH NAME
lmdbg \- all-in-one high-level LMDBG tool
.SH SYNOPSIS
.BI lmdbg " [OPTIONS] <prog> [args...]"
.SH DESCRIPTION
.B lmdbg
runs an external program
.I prog
and collects its memory leaks and double
frees in a specified log file. 
.B lmdbg
uses
.BR lmdbg-run ", " lmdbg-leaks ", " lmdbg-sym ", and " lmdbg-sysleaks "."
.SH OPTIONS
.TP
.B "-h"
Display help message.
.TP
.BI "-V"
Display the lmdbg version.
.TP
.BI "-o" " filename"
Specify the log file.
.TP
.BI -M " mode"
where
.I mode
is either of the following.
.RS
.TP
.IR "d" " or " "default"
All stacktraces with memory leaks are output.
This is the default.
.TP
.IR "l" " or " "leaks"
Ordered stacktraces are output.
.TP
.IR "p" " or " "peak"
Ordered stacktraces are output.
.TP
.IR "a" " or " "allocs"
Ordered stacktraces are output.
.TP
.IR "m" " or " "max"
Ordered stacktraces are output.
.RE
.TP
.BI "-c" " filename"
Option
.BI -c " filename"
is passed
.BR lmdbg-sysleaks(1) .
.TP
.B "-a"
Option
.BI -a
is passed
.BR lmdbg-sym(1) .
.TP
.B "-g"
Option
.BI -g
is passed
.BR lmdbg-sym(1) .
This is the default.
.TP
.B "-n"
Option
.B -n
is passed
.BR lmdbg-run(1) .
.TP
.BI "-T" " num"
Option
.BI -T " num"
is passed
.BR lmdbg-run(1) .
.TP
.BI "-B" " num"
Option
.BI -B " num"
is passed
.BR lmdbg-run(1) .
.TP
.B "-v"
Enable verbose mode.
.SH FILES
.TP
.IR ~/.lmdbg.conf " or " @sysconfdir@/lmdbg.conf
.B lmdbg
configuration file
.SH EXAMPLE
.VB
$ cat test3.c
#include <stdlib.h>

int main ()
{
   int i;
   void *p1, *p2;
   p1 = malloc (900);
   for (i=0; i < 3; ++i){
      p2 = realloc (NULL, 10+300*i);
   }
   free (p1);
   free (p2);

   return 0;
}
$ cc -O0 -g -o test3 test3.c
$ lmdbg -o log ./test3; cat log
realloc ( NULL , 10 ) --> 0xbb901040 num: 2
 0xbbbddb7a     lmdbg.c:140     log_stacktrace
 0xbbbde68c     lmdbg.c:545     realloc
 0x80487c7      test3.c:9       main
 0x804866d
 0x80486a8
realloc ( NULL , 310 ) --> 0xbb912140 num: 3
 0xbbbddb7a     lmdbg.c:140     log_stacktrace
 0xbbbde68c     lmdbg.c:545     realloc
 0x80487c7      test3.c:9       main
 0x804866d
 0x80486a8
$ lmdbg -M leaks -o log ./test3; cat log
info progname ./test3
info stat total_allocs: 2
info stat total_free_cnt: 0
info stat total_leaks: 320
stacktrace peak: 320 max: 310 allocs: 2 leaks: 320
 0xbbbddb7a     lmdbg.c:140     log_stacktrace
 0xbbbde68c     lmdbg.c:545     realloc
 0x80487c7      test3.c:9       main
 0x804866d
 0x80486a8
$ lmdbg -M peak -o log ./test3; cat log
info progname ./test3
info stat total_allocs: 4
info stat total_free_cnt: 2
info stat total_leaks: 320
stacktrace peak: 930 max: 610 allocs: 3 leaks: 320
 0xbbbddb7a     lmdbg.c:140     log_stacktrace
 0xbbbde68c     lmdbg.c:545     realloc
 0x80487c7      test3.c:9       main
 0x804866d
 0x80486a8
stacktrace peak: 900 max: 900 allocs: 1
 0xbbbddb7a     lmdbg.c:140     log_stacktrace
 0xbbbde53b     lmdbg.c:509     malloc
 0x8048789      test3.c:7       main
 0x804866d
 0x80486a8
$ lmdbg -M max -o log ./test3; cat log
info progname ./test3
info stat total_allocs: 4
info stat total_free_cnt: 2
info stat total_leaks: 320
stacktrace peak: 900 max: 900 allocs: 1
 0xbbbddb7a     lmdbg.c:140     log_stacktrace
 0xbbbde53b     lmdbg.c:509     malloc
 0x8048789      test3.c:7       main
 0x804866d
 0x80486a8
stacktrace peak: 930 max: 610 allocs: 3 leaks: 320
 0xbbbddb7a     lmdbg.c:140     log_stacktrace
 0xbbbde68c     lmdbg.c:545     realloc
 0x80487c7      test3.c:9       main
 0x804866d
 0x80486a8
$ lmdbg -M allocs -o log ./test3; cat log
info progname ./test3
info stat total_allocs: 4
info stat total_free_cnt: 2
info stat total_leaks: 320
stacktrace peak: 930 max: 610 allocs: 3 leaks: 320
 0xbbbddb7a     lmdbg.c:140     log_stacktrace
 0xbbbde68c     lmdbg.c:545     realloc
 0x80487c7      test3.c:9       main
 0x804866d
 0x80486a8
stacktrace peak: 900 max: 900 allocs: 1
 0xbbbddb7a     lmdbg.c:140     log_stacktrace
 0xbbbde53b     lmdbg.c:509     malloc
 0x8048789      test3.c:7       main
 0x804866d
 0x80486a8
$
.VE
.SH SEE ALSO
.BR lmdbg-run(1) ,
.BR lmdbg-sym(1) ,
.BR lmdbg-leaks(1) ,
.B lmdbg-sysleaks(1)
.SH AUTHOR
Aleksey Cheusov <vle@gmx.net>
